<!DOCTYPE HTML>
<html>
<head>
	<!--Import Google Icon Font-->
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--Import materialize.css-->
	<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
	

	<!--Let browser know website is optimized for mobile-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<style>
      /* Always set the map height explicitly to define the size of the div
      * element that contains the map. */
      #map {
      	height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
      	height: 100%;
      	margin: 0;
      	padding: 0;
      }
  </style>
  <script>
  	var userAgent = navigator.userAgent + '';
  	if (userAgent.indexOf('iPhone') > -1) {
  		document.write('<script src="js/cordova-iphone.js"></sc' + 'ript>');
  		var mobile_system = 'iphone';
  	} else if (userAgent.indexOf('Android') > -1) {
  		document.write('<script src="js/cordova-android.js"></sc' + 'ript>');
  		var mobile_system = 'android';
  	} else {
  		var mobile_system = '';
  	}
  </script>
  <script type="text/javascript">

      // This example requires the Places library. Include the libraries=places
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">
      function getLoc(){
      	navigator.geolocation.getCurrentPosition(onSuccess, onError, { timeout: 30000 });
      }
      var map;
      var infowindow;
      var latLong;
      function onSuccess(position) {
			//console.log('success');
			var lat=position.coords.latitude;
			var long=position.coords.longitude;
			latLong = {lat: lat, lng: long};
			initMap();

		}

		function onError(error){
			alert('code: '+error.code+'\n'+
				'message: '+error.message + '\n');
		}
		function initMap() {
        // var pyrmont = {lat: -33.867, lng: 151.195};
        // latLong = {lat: 5.60372, lng: -0.18696};
        map = new google.maps.Map(document.getElementById('map'), {
        	center: latLong,
        	zoom: 15
        });
        var place=localStorage.getItem('place');
        infowindow = new google.maps.InfoWindow();
        var service = new google.maps.places.PlacesService(map);
        service.nearbySearch({
        	location: latLong,
        	radius: 500,
        	type: [place]
        }, callback);
    }

    function callback(results, status) {
    	if (status === google.maps.places.PlacesServiceStatus.OK) {
    		for (var i = 0; i < results.length; i++) {
    			createMarker(results[i]);
    		}
    	}
    	else{
    		$("#error").fadeIn(1000, function(){
    			
						$("#error").html('<div class="alert alert-danger"><i class="material-icons">info_outline</i> &nbsp; Not found !</div>');

					});
    	}
    }

    function createMarker(place) {
    	var placeLoc = place.geometry.location;
    	var marker = new google.maps.Marker({
    		map: map,
    		position: place.geometry.location
    	});

    	google.maps.event.addListener(marker, 'click', function() {
    		infowindow.setContent(place.name);
    		infowindow.open(map, this);
    	});
    }

    
</script>


<script type="text/javascript" src="js/jquery-3.1.1.js"></script>
<script src="js/bootstrap.js"></script>
<script type="text/javascript" src="js/materialize.min.js"></script>

</head>
<body>
	
	<nav>
		<div class="nav-wrapper">
			<a href="#!" class="brand-logo">FindMe A...</a>

			<ul class="right hide-on-med-and-down">
				<li><a href="sass.html">Sass</a></li>
				<li><a href="badges.html">Components</a></li>
				<li><a href="collapsible.html">Javascript</a></li>
				<li><a href="mobile.html">Mobile</a></li>
			</ul>
			<ul class="side-nav" id="slide-out">
				<li><a href="home.html">Home</a></li>
				<li><a href="badges.html">Components</a></li>
				<li><a href="collapsible.html">Javascript</a></li>
				<li><a href="mobile.html">Mobile</a></li>
			</ul>
			<a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
		</div>
	</nav>

	
	<br />
	<div class="container">
		<div id="error">
			<!-- error will be showen here ! -->
		</div>
		

		
		<div id="map" style="height:500px">
			<!-- map here -->
		</div>
	</div>

	
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCnZo0yYNIxiuZKL4pY9EgcMnufoqdiGIg&libraries=places&callback=getLoc" async defer></script>

	<script type="text/javascript" src="js/index.js"></script><!--Import jQuery before materialize.js-->
	<link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	
	<script type="text/javascript" src="js/platformOverrides.js"></script>
	<script>
		
	</script>
</body>
</html>